(window.webpackJsonp=window.webpackJsonp||[]).push([[76],{583:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){var n=e.className,t=void 0===n?"":n,r=e.slotKey;return o.default.createElement(o.default.Fragment,null,o.default.createElement(a.default,{slotKey:r,className:t,markDownString:"\n# [@mdpress/plugin-pwa](https://github.com/docschina/mdpress/tree/master/packages/@mdpress/plugin-pwa)\n\n> PWA 插件\n\n## 安装\n\n```bash\nyarn add -D @mdpress/plugin-pwa\n# OR npm install -D @mdpress/plugin-pwa\n```\n\n## 使用\n\n```javascript\nmodule.exports = {\n  plugins: ['@mdpress/pwa']\n}\n```\n\n::: tip\n为了让你的网站完全地兼容 PWA，你需要:\n\n- 在 `.mdpress/public` 提供 Manifest 和 icons\n- 在 `.mdpress/config.js` 添加正確的 [head links](/config/#head)(参见下面例子).\n\n更多细节，请参见 [MDN docs about the Web App Manifest](https://developer.mozilla.org/en-US/docs/Web/Manifest).\n:::\n\n这是一个在 MdPress 中完全地兼容 PWA 的例子：\n\n```javascript\nmodule.exports = {\n  head: [\n    ['link', { rel: 'icon', href: '/logo.png' }],\n    ['link', { rel: 'manifest', href: '/manifest.json' }],\n    ['meta', { name: 'theme-color', content: '#3eaf7c' }],\n    ['meta', { name: 'apple-mobile-web-app-capable', content: 'yes' }],\n    ['meta', { name: 'apple-mobile-web-app-status-bar-style', content: 'black' }],\n    ['link', { rel: 'apple-touch-icon', href: '/icons/apple-touch-icon-152x152.png' }],\n    ['link', { rel: 'mask-icon', href: '/icons/safari-pinned-tab.svg', color: '#3eaf7c' }],\n    ['meta', { name: 'msapplication-TileImage', content: '/icons/msapplication-icon-144x144.png' }],\n    ['meta', { name: 'msapplication-TileColor', content: '#000000' }]\n  ],\n  plugins: ['@mdpress/pwa', {\n      serviceWorker: true,\n      updatePopup: true\n  }],\n}\n```\n\n## 选项\n\n### serviceWorker\n\n- 类型: `boolean`\n- 默认值: `true`\n\n如果设置为 `true`，MdPress 将自动生成并注册一个 [Service Worker](https://developers.google.com/web/fundamentals/primers/service-workers/)，用于缓存页面的内容以供离线使用（仅会在生产环境中启用）。\n\n有一个别名化的模块 `@sw-event` 模块将会 emit 以下事件：\n\n- `sw-ready`\n- `sw-cached`\n- `sw-updated`\n- `sw-offline`\n- `sw-error`\n\n::: tip\n只有在你能够使用 SSL 部署您的站点时才能启用此功能，因为 service worker 只能在 HTTPs 的 URL 下注册。\n:::\n\n### generateSWConfig\n\n- 类型: `object`\n- 默认值: `{}`\n\nworkbox-build 的 [generateSW config](https://developers.google.com/web/tools/workbox/modules/workbox-build#full_generatesw_config)。\n\n\n### updatePopup\n\n- 类型: `boolean|popupConfig`\n- 默认值: `undefined`\n\n类型 `popupConfig` 的定义如下：\n\n```typescript\ninterface normalPopupConfig {\n  message: string; // defaults to 'New content is available.'\n  buttonText: string; // defaults to 'Refresh'\n}\n\ninterface localedPopupConfig {\n  [localePath: string]: normalPopupConfig\n}\n\ntype popupConfig = normalPopupConfig | localedPopupConfig\n```\n\n本选项开启了一个用于刷新内容的弹窗。这个弹窗将会在站点有内容更新时显示出来，并提供了一个 `refresh` 按钮，允许用户立即刷新内容。\n\n> 如果没有“刷新”按钮，则只有在所有的 [Clients](https://developer.mozilla.org/en-US/docs/Web/API/Clients) 被关闭后，新的 Service Worker 才会处于活动状态。这意味着用户在关闭你网站的所有标签之前无法看到新内容。但是 `refresh` 按钮会立即激活新的 Service Worker。\n\n### popupComponent\n\n- 类型: `string`\n- 默认值: `undefined`\n\n用于替换默认弹出组件的自定义组件。\n\n**参考:**\n\n- [自定义 SW-Update Popup](#自定义-sw-update-popup-的-ui)\n\n## 自定义 SW-Update Popup 的 UI\n\n默认的 SW-Update Popup 组件提供了一个属性，使您能够完全控制弹窗的外观。\n\n首先，您需要在 `.mdpress/components` 中创建一个全局组件（例如`MySWUpdatePopup`)。 一个基于默认组件创建的简单组件如下：\n\n```jsx\n// .mdpress/components/MySWUpdatePopup.js\nimport React from 'react';\nimport SWUpdatePopup from '@mdpress/plugin-pwa/lib/SWUpdatePopup.js';\nimport './popup.styl';\n\nexport default function MySWUpdatePopup() {\n  return <SWUpdatePopup render={(enabled, reload, message, buttonText) => {\n    return enabled && <div\n      className=\"my-sw-update-popup\">\n      { message }\n      <br/>\n      <button onClick=\"reload\">{ buttonText }</button>\n    </div>;\n  }}/>;\n}\n```\n\n```stylus\n// .mdpress/components/popup.styl\n.my-sw-update-popup {\n  text-align: right;\n  position: fixed;\n  bottom: 20px;\n  right: 20px;\n  background-color: #fff;\n  font-size: 20px;\n  padding: 10px;\n  border: 5px solid #3eaf7c;\n}\n\n.my-sw-update-popup button {\n  border: 1px solid #fefefe;\n}\n```\n\n接着，更新你的插件配置：\n\n``` diff\nmodule.exports = {\n   plugins: {\n    '@mdpress/pwa': {\n       serviceWorker: true,\n+      popupComponent: 'MySWUpdatePopup',\n       updatePopup: true\n     }\n  }\n}\n```\n\n**参考:**\n\n- [MdPress > 使用组件](../../guide/using-react.md#使用组件)\n"}))};var o=r(t(0)),a=r(t(608));function r(e){return e&&e.__esModule?e:{default:e}}},604:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(){return r.default.createElement("svg",{className:"icon outbound",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",x:"0px",y:"0px",viewBox:"0 0 100 100",width:"15",height:"15"},r.default.createElement("path",{fill:"currentColor",d:"M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"}),r.default.createElement("polygon",{fill:"currentColor",points:"45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"}))};var o,a=t(0),r=(o=a)&&o.__esModule?o:{default:o};t(606)},605:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){var n=(0,a.default)().$page,t=e.pageKey,u=void 0===t?n.key:t,s=e.className,p=e.slotKey,i=void 0===p?"default":p;(0,l.setGlobalInfo)("pageKey",u);var d=r.default[u]||function(){return null};return o.default.createElement(d,{className:s,slotKey:i})};var o=u(t(0)),a=u(t(99)),r=u(t(164)),l=t(36);function u(e){return e&&e.__esModule?e:{default:e}}t(607)},606:function(e,n,t){},607:function(e,n,t){},608:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=b(t(100)),a=b(t(29)),r=b(t(166)),l=t(0),u=b(l),s=b(t(4)),p=t(101),i=b(t(99)),d=b(t(102)),c=t(165),f=b(t(609)),m=b(t(605)),g=b(t(604)),v=b(t(37));function b(e){return e&&e.__esModule?e:{default:e}}var h="server"===(0,t(36).getEnv)();function w(e){var n=e.markDownString,t=e.className,s=e.slotKey,b=(0,l.useRef)(e.md||v.default.createMD()).current,w=(0,i.default)(),P=w.$site,S=w.$page,k=(0,l.useState)(null),x=(0,a.default)(k,2),M=x[0],_=x[1],C=(0,l.useRef)(null);return(0,l.useEffect)((function(){_(document.getElementById(s))}),[]),(0,l.useEffect)((function(){"default"!==s&&C&&M&&((0,o.default)(M.childNodes).forEach((function(e,n){var t=C.current.childNodes[n];t?C.current.replaceChild(e,t):C.current.appendChild(e)})),M.parentNode.removeChild(M))}),[M]),"default"!==s?u.default.createElement("div",{ref:C}):((0,c.useComponentWillMount)((function(){!function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e.use((function(e){return(0,p.SupportReactComponent)(e,{allowErrorLog:!0,sandbox:(0,r.default)({},n,t),babelInit:function(e){e.availablePlugins.filterXSS&&(e.availablePlugins.filterXSS=function(){return{}})}})}))}(b,d.default,{$site:P,$page:S,JSON:JSON,ClientOnly:f.default,console:console,Content:m.default,OutboundLink:g.default,$withBase:function(e){var n=P.base;return"/"===e.charAt(0)?n+e.slice(1):e}})})),h?u.default.createElement(y,{html:b.render(n),slotKey:s,className:t}):(0,l.useMemo)((function(){var e=b.render(n);return u.default.createElement(y,{html:e,slotKey:s,className:t})}),[n,s,t]))}function y(e){var n=e.html,t=e.slotKey,o=e.className;return u.default.createElement("div",{className:"content content__"+t+" "+o,dangerouslySetInnerHTML:{__html:n}})}w.propTypes={markDownString:s.default.string,className:s.default.string,scrollAnchor:s.default.bool,mdInit:s.default.func,md:s.default.object},w.defaultProps={markDownString:"",className:"",scrollAnchor:!0,mdInit:function(){}},n.default=w},609:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=l(t(29));n.default=function(e){var n=(0,a.useState)(!1),t=(0,o.default)(n,2),l=t[0],s=t[1],p=e.children,i=e.onSSR,d=void 0===i?r.default.createElement(u,null):i;return(0,a.useEffect)((function(){s(!0)}),[]),l?p:d};var a=t(0),r=l(a);function l(e){return e&&e.__esModule?e:{default:e}}var u=function(){return r.default.createElement("span",null)}}}]);